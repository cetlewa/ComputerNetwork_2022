# 計算機網絡——自頂向下

## ch1. 計算機網絡與因特網

### · 因特網構成

兩種描述方式：具體構成 (基本硬件 + 軟件組件) or 服務描述 (為分布式應用提供服務的聯網基礎設施)

#### 具體構成

端系統 (host)：與因特網連結的計算機和其他設備稱為端系統 (位於因特網的邊緣) -> 通過**通信鏈路** (同軸電纜、銅線、光纖、 無線電頻譜...) 和**分組交換機** (路由器，鏈路層交換機) 連接到一起

傳輸速率：單位 bit/s bps

分組：發送數據時將數據分段並為每段加上首部字節，形成信息包

因特網服務提供商ISP：提供因特網接入服務，獨立管理，運行IP協議，遵從一定的命名和地址規則

因特網中**最重要的兩個協議**：TCP (Transmition Control Protocol) 與 IP (Internet Protocol) -> TCP/IP

IP定義了路由器和端系統之間發送和接收的分組格式

#### 服務描述

套接字接口：規定運行在一個端系統上程序請求英特網基礎設施向另一個端系統上特定目的地程序交付數據的方式 -> 規則集合

#### 協議 Protocol

定義了在兩個或多個通信實體之間交換的報文的格式和順序，以及報文發送和接收一條報文或其他事件採取的行動

### · 網絡邊緣

端系統 (主機)：客戶機和服務器

接入網：將端系統物理連結到其邊緣路由器的網絡

高速下行信道，位于50kHz到1MHz频段；中速上行信道，位于4kHz到50kHz频段；普通的双向电话信道，位于0到4kHz频段

電纜因特網接入：共享廣播媒體是一個重要特征

雙絞銅線：10Mbps～10Gbps

同軸電纜：數十Mbps，用作導引型共享媒體

光纖通信：每個脈衝表示一個比特，數十～數百Gbps，不受電磁干擾，長途導引型傳輸媒體 (跨海鏈路)

### · 網絡核心

端系統彼此交換報文，將長報文劃分為較小的數據快為分組，通過通信鏈路和分組交換機 (路由器和鏈路層交換機) 傳送

#### 存儲轉發傳輸機制

交換機能夠開始向輸出鏈路傳輸該分組的第一個比特之前，必須接收到整個分組

![image-20220119173559825](/Users/stephenking/Library/Application Support/typora-user-images/image-20220119173559825.png)

輸出緩存：存儲路由器準備發往鏈路的分組，存在排隊時延與存儲轉發時延。由於緩存大小有限，可能出現分組丟失 (丟包)。

轉發表：路由器擁有，用於將目的地址映射為輸出鏈路

路由選擇協議：因特網用於自動設置轉發表

#### 電路交換

鏈路中的電路通過頻分復用或時分復用實現

對於TDM，一條電路的**傳輸速率**等於**幀速率**乘以**一個時隙中的比特數量**

**例題**：考虑从主机A到主机B经一个电路交换网络发送一个640 000比特的文件需要多长时间。假如在该网络中所有链路使用具有24时隙的TDM,比特速率为1.536Mbps。同时假定在主机A能够开始传输该文件之前，需要500ms创建一条端到端电路。它需要多长时间才能发送该文件?

每条链路具有的传输速率是1. 536Mbps/24 = 64kbps，因此传输该文件需要(640kb)/(64kbps) =10s。这个10s，再加上电路创建时间，这样就需要10. 5s发送该文件。

**分組交換相比電路交換的優點**：提供了比電路交換更好的帶寬共享；比電路交換更簡單有效，實現成本低。

#### 分組交換

##### 節點時延

種類：處理時延Dproc、排隊時延Dqueue、傳輸時延Dtrans、傳播時延Dprop

傳輸時延：L比特表示分組的長度，R bps表示從路由器A到路由器B的鏈路傳輸速率，傳輸時延是L/R

傳播時延：從鏈路的起點到路由器B傳播需要的時間，範圍2\*10^8~3\*10^8 m/s，計算式d/s (d為兩路由器之間距離，s為鏈路傳播速度)

**區分傳輸時延與傳播時延**：传输时延是路由器推出分组所需要的时间，是分组长度和链路传输速率的函数。传播时延是一个比特从一台路由器传播到另一台路由器所需要的时间，是两台路由器之间距离的函数。

流量強度：La/R (分組由L比特組成，分組到達隊列平均速率a，傳輸速率R)，工程中保證流量強度不能大於1 (大於1意味著比特到達平均速率大於傳輸出去的速率，對列會趨於無窮長)

##### 丟包

到達分組發現滿的對列後由於沒有地方存儲這個分組，路由器將丟棄該分組

##### 吞吐量

瞬時吞吐量與平均吞吐量

對於簡單網絡來說，吞吐量就是瓶頸鏈路的傳輸速率 min{R1,R2,...,Rn}

#### 協議分層

因特網的協議棧：物理層，鏈路層，網絡層，運輸層，應用層

**應用層**：網絡應用程序和應用層協議 (HTTP, SMTP, FTP) 存放的地方，位於應用層的信息分組稱為報文

**運輸層**：應用程序端點之間傳送應用層報文，有TCP和UDP兩種協議。TCP面向連接，將長報文劃分為短報文，提供擁塞控制機制；UDP提供無連結服務。位於運輸層的分組稱為報文段。

**網絡層 (IP層)**：將數據報的網絡層分組從一台主機移動到另一台主機

**鏈路層**：沿著路徑將數據報傳遞給下一個節點，並在下一個節點將數據報上傳給網絡層。鏈路層分組稱為幀。

**物理層**：將該幀中的比特從一個節點移動到下一個節點。協議仍然是鏈路相關的。

#### OSI模型

7層，開放系統互連模型：應用層，表示層，會話層，運輸層，網絡層，數據鏈路層，物理層

表示層：使通信的應用程序能夠解釋交換數據的含義，服務包括數據壓縮和數據加密以及數據描述。

會話層：提供數據交換的定界和同步功能

